# Trigger GCP workflows from eventarc

![Solution diagram](bin/diagram.png?raw=true "Solution schema")

This repository offers a way to launch a GCP Cloud Workflows instance from an Eventarc trigger.

At the moment of this publication Eventarc can only be use with Cloud Run, and Workflows only be triggered by a gcloud command or a REST call.

To demonstrate the process, a Cloud Run will be triggered by an Eventarc generated by the creation of an object in GCS. The Cloud Run instance will in turn trigger a simple workflow, passing it at the same time arguments taken from the Eventarc.

Namely, this architecture ensures that when a file is uploaded to a bucket (any bucket, at the moment of the writing wildcards are not supported in Eventarc triggers), a Cloud Run instance will pass the name of the bucket and the name of the uploaded object to the workflow, which will simply print it.

# How to deploy

Use the Makefile